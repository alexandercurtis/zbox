/**
 * zbox - lightbox and zoomer combo for jQuery
 *
 * Copyright 2013 Arcitus Solutions Ltd.
 * http://www.arcitus.co.uk/
 * Not to be used without permission.
 *
 * Version 1.0.1 - 09th August 2017
 *
 * Developed for jQuery 1.8.2
 *
 */
;!function(i,n,o,c){"use strict";var s={margin:10},e={c:null,o:{},s:function(c){e.cin=e.cn.index(this),e.sd=!1,e.r=!0,i(this).blur(),i(o).on("keydown.zbox",function(i){27==i.which||13==i.which?(e.sdn(),i.preventDefault()):37==i.which||38==i.which||8==i.which?(e.p(),i.preventDefault()):39!=i.which&&40!=i.which&&32!=i.which||(e.n(),i.preventDefault())}),i(n).resize(function(){e.rf(!1)}),e.window=i(n),e.so(),e.li(),c.preventDefault()},so:function(){e.ov=i('<div id="zbox-overlay"></div>').appendTo("body"),e.ov.click(e.sdn),e.ov.animate({opacity:.7},{duration:250,easing:"swing"})},sdn:function(){e.sd=!0,e.sp&&(e.sp.remove(),e.sp=null),e.c&&e.c.animate({opacity:.1},{duration:250,easing:"swing"}),e.ov?e.ov.animate({opacity:.1},{duration:250,easing:"swing",complete:e.sdf}):e.sdf()},sdf:function(){e.sd=!0,e.ov&&(e.ov.remove(),e.ov=null),e.c&&(e.c.remove(),e.c=null),e.sp&&(e.sp.remove(),e.sp=null),e.i=null,e.nil=0,e.ail=!1,i(".zbox-screen").unbind(".zbox"),i(o).off(".zbox")},li:function(){e.i=new Array,e.nil=0,e.ail=!1,e.cn.each(function(){var n=new Image;n.onload=function(){e.sd||++e.nil==e.cn.length&&(e.ail=!0,e.hs(),e.bi(),e.si(),e.sm())},n.onerror=function(i){console&&console.warn("Error loading image "+n.src),e.hs(),e.sdf()};var o=i(this).attr("href"),c=i(this).attr("title");n.src=o,e.i.push({img:n,href:o,title:c})}),e.ail||e.ss()},ss:function(){if(!e.sd){e.sp=i('<div id="zbox-spinner">Loading...</div>'),e.sp.css("left",e.window.scrollLeft()-16+e.window.width()/2),e.sp.css("top",e.window.scrollTop()-16+e.window.height()/2),e.ail||e.sp.appendTo("body")}},hs:function(){e.sp&&(e.sp.remove(),e.sp=null)},bi:function(){e.c=i('<div class="zbox-content"></div>');var n=e.i[e.cin].href,o=e.i[e.cin].title,c=e.i[e.cin].img,s='<img src="'+n+'" alt="'+o+'"/>';e.im=i(s);var t=c.width,a=c.height,d=e.window.width()-2*e.o.margin,r=e.window.height()-2*e.o.margin,l=d-80,f=r-20,p=t/a,h=l,u=f;p>l/f?l<t?u=Math.ceil(l/p):(h=t,u=a):f<a?h=Math.ceil(f*p):(h=t,u=a),e.im.width(h),e.im.height(u),e.c.css("left",Math.ceil(e.o.margin+(d-(h+80))/2)+"px"),e.c.css("top",Math.ceil(e.o.margin+(r-(u+20))/2)+"px"),e.i.length>1&&(i('<div class="zbox-button left"></div>').css("top",Math.ceil((u+20)/2-6)+"px").appendTo(e.c).click(e.p),i('<div class="zbox-button right"></div>').css("top",Math.ceil((u+20)/2-6)+"px").appendTo(e.c).click(e.n)),i('<div class="zbox-button close"></div>').appendTo(e.c).click(e.sdn),e.d={iw:t,ih:a,ww:d,wh:r,nw:h,nh:u}},si:function(i){e.im.appendTo(e.c),e.c.appendTo("body"),i?e.c.animate({opacity:1},{duration:250,easing:"swing",complete:function(){e.r=!1}}):(e.c.css("opacity",1),e.r=!1)},mon:function(){e.showingMag=!0,e.mag&&e.mag.css("display","block")},moff:function(){e.showingMag=!1,e.mag&&e.mag.css("display","none")},sm:function(n,o){function c(i,n,o,c){var s=a.left+e.window.scrollLeft(),t=a.top+e.window.scrollTop(),d=i-s;"undefined"!=typeof zoom_offset&&(d-=zoom_offset);var r=n-t,l=d/e.d.nw,f=r/e.d.nh,p=100-l*e.d.iw,h=100-f*e.d.ih;jQuery("#zbox-magnifier").css("left",o-100).css("top",c-100).css("background-position",p+"px "+h+"px")}if(e.d.nw<e.d.iw||e.d.nh<e.d.ih){var s=e.mag=i('<div id="zbox-magnifier">&nbsp;</div>').appendTo(e.c);e.moff(),s.css("background-image","url("+e.i[e.cin].href+")");var t=i('<div class="zbox-screen"></div>').appendTo(e.c);t.width(e.d.nw),t.height(e.d.nh),t.css("left","40px"),t.css("top","10px"),t.css("font-size",e.d.nh+"px"),navigator.userAgent.match(/msie/i)?t.css("cursor","url(blank.cur)"):t.css("cursor","none"),t.bind("mouseenter.zbox",function(i){c(i.pageX,i.pageY,i.clientX,i.clientY),e.mon()}),t.bind("mouseleave.zbox",e.moff);var a=t.offset();a&&t.bind("mousemove.zbox",function(i){e.showingMag&&c(i.pageX,i.pageY,i.clientX,i.clientY)})}},p:function(){e.r||(0==e.cin&&(e.cin=e.i.length),--e.cin,e.rf(!0))},n:function(){e.r||(++e.cin==e.i.length&&(e.cin=0),e.rf(!0))},rf:function(n){e.r=!0,e.moff(),i(".zbox-screen").unbind(".zbox"),n?e.c.animate({opacity:.1},{duration:250,easing:"swing",complete:function(){e.c.remove(),e.bi(),e.si(!0),e.sm()}}):(e.c.remove(),e.bi(),e.si(!1),e.sm())}};i.fn.zbox=function(n){return e.o=i.extend({},s,n),e.cn=this,this.each(function(){i(this).click(e.s)})}}(jQuery,window,document);
